"use strict";exports.id=808,exports.ids=[808],exports.modules={4808:(e,r,s)=>{s.d(r,{W:()=>verifyToken});var o=s(9344),n=s.n(o);let verifyToken=(e,r)=>new Promise(s=>{let o=e.headers.authorization;if(!o||!o.startsWith("Bearer "))return console.log("Auth: Missing or invalid Authorization header"),r.status(401).json({message:"Unauthorized - Missing or invalid token format"}),s(null);let t=o.split(" ")[1];if(!process.env.JWT_SECRET)return console.error("Auth: JWT_SECRET environment variable is not defined"),r.status(500).json({message:"Server configuration error - Missing JWT secret"}),s(null);try{let e=n().verify(t,process.env.JWT_SECRET);s(e)}catch(e){console.error("Auth: JWT verification error",{error:e.message,name:e.name}),"JsonWebTokenError"===e.name?r.status(401).json({message:"Invalid token - "+e.message}):"TokenExpiredError"===e.name?r.status(401).json({message:"Expired token"}):r.status(500).json({message:"Token verification error"}),s(null)}})}};