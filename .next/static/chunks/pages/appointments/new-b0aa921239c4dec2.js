(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[84],{63:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/appointments/new",function(){return a(6227)}])},6227:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return NewAppointment}});var o=a(5893),r=a(5379),n=a.n(r),s=a(7294),i=a(1163),l=a(9008),d=a.n(l),c=a(1664),m=a.n(c),p=a(7317),h=a.n(p);function NewAppointment(){let e=(0,i.useRouter)(),[t,a]=(0,s.useState)([]),[r,l]=(0,s.useState)(""),[c,p]=(0,s.useState)("general-checkup"),[u,f]=(0,s.useState)(""),[g,x]=(0,s.useState)([]),[b,j]=(0,s.useState)(""),[_,y]=(0,s.useState)(""),[v,k]=(0,s.useState)(""),[w,S]=(0,s.useState)(!1),[N,D]=(0,s.useState)(!0),[T,C]=(0,s.useState)(!1),[E,F]=(0,s.useState)(null);(0,s.useEffect)(()=>{let t=localStorage.getItem("token");if(!t){e.push("/auth/login");return}let fetchDoctors=async()=>{try{let e=await fetch("/api/doctors",{headers:{Authorization:"Bearer ".concat(t)}});if(!e.ok)throw Error("Failed to fetch doctors: ".concat(e.status));let o=await e.json();a(o.doctors)}catch(e){console.error("Error fetching doctors:",e),F(e.message||"Failed to load doctors")}finally{D(!1)}};fetchDoctors()},[e]),(0,s.useEffect)(()=>{if(r&&u){let fetchTimeSlots=async()=>{let e=localStorage.getItem("token");if(e)try{D(!0);let t=await fetch("/api/doctors/".concat(r,"/availability?date=").concat(u),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error("Failed to fetch time slots: ".concat(t.status));let a=await t.json();x(a.timeSlots),j("")}catch(e){console.error("Error fetching time slots:",e),F(e.message||"Failed to load time slots")}finally{D(!1)}};fetchTimeSlots()}},[r,u]);let handleSubmit=async t=>{if(t.preventDefault(),!r){F("Please select a doctor");return}if(!u){F("Please select a date");return}if(!b){F("Please select a time slot");return}if(!_){F("Please provide a reason for your visit");return}let a=localStorage.getItem("token");if(!a){e.push("/auth/login");return}try{C(!0),F(null);let t=await fetch("/api/appointments",{method:"POST",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"},body:JSON.stringify({doctorId:r,dateTime:"".concat(u,"T").concat(b),type:c,reasonForVisit:_,symptoms:v.split(",").map(e=>e.trim()).filter(e=>e),isVirtual:w})});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to book appointment: ".concat(t.status))}let o=await t.json();e.push("/appointments/".concat(o.appointment.id))}catch(e){console.error("Error booking appointment:",e),F(e.message||"Failed to book appointment"),C(!1)}};return N&&0===t.length?(0,o.jsx)("div",{className:h().container,children:(0,o.jsxs)("div",{style:{textAlign:"center",padding:"50px 0"},className:"jsx-7b580fbd0b64e6d5",children:[(0,o.jsx)("h2",{className:"jsx-7b580fbd0b64e6d5",children:"Loading..."}),(0,o.jsx)("div",{style:{margin:"20px auto",width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #3498db",borderRadius:"50%",animation:"spin 1s linear infinite"},className:"jsx-7b580fbd0b64e6d5"}),(0,o.jsx)(n(),{id:"7b580fbd0b64e6d5",children:"@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-moz-keyframes spin{0%{-moz-transform:rotate(0deg);transform:rotate(0deg)}100%{-moz-transform:rotate(360deg);transform:rotate(360deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-o-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{0%{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-o-transform:rotate(360deg);transform:rotate(360deg)}}"})]})}):(0,o.jsxs)("div",{className:h().container,children:[(0,o.jsxs)(d(),{children:[(0,o.jsx)("title",{children:"Book New Appointment - Digital Healthcare Platform"}),(0,o.jsx)("meta",{name:"description",content:"Book a new medical appointment"})]}),(0,o.jsxs)("header",{className:h().header,children:[(0,o.jsx)("h1",{children:"Book New Appointment"}),(0,o.jsx)("div",{children:(0,o.jsx)(m(),{href:"/appointments",style:{marginRight:"15px"},children:"Back to Appointments"})})]}),(0,o.jsx)("main",{className:h().main,children:(0,o.jsxs)("div",{className:h().formContainer,children:[E&&(0,o.jsx)("div",{style:{padding:"10px",margin:"0 0 20px",background:"#fee2e2",border:"1px solid #ef4444",borderRadius:"8px"},children:(0,o.jsx)("p",{children:E})}),(0,o.jsxs)("form",{onSubmit:handleSubmit,children:[(0,o.jsxs)("div",{className:h().formGroup,children:[(0,o.jsx)("label",{htmlFor:"doctor",children:"Select Doctor"}),(0,o.jsxs)("select",{id:"doctor",className:h().formSelect,value:r,onChange:e=>l(e.target.value),required:!0,children:[(0,o.jsx)("option",{value:"",children:"-- Select a doctor --"}),t.map(e=>(0,o.jsxs)("option",{value:e.id,children:["Dr. ",e.name," - ",e.specialization,e.department&&" (".concat(e.department,")")]},e.id))]})]}),(0,o.jsxs)("div",{className:h().formGroup,children:[(0,o.jsx)("label",{htmlFor:"appointmentType",children:"Appointment Type"}),(0,o.jsxs)("select",{id:"appointmentType",className:h().formSelect,value:c,onChange:e=>p(e.target.value),required:!0,children:[(0,o.jsx)("option",{value:"general-checkup",children:"General Checkup"}),(0,o.jsx)("option",{value:"follow-up",children:"Follow-up"}),(0,o.jsx)("option",{value:"consultation",children:"Consultation"}),(0,o.jsx)("option",{value:"vaccination",children:"Vaccination"}),(0,o.jsx)("option",{value:"telemedicine",children:"Telemedicine"})]})]}),(0,o.jsxs)("div",{className:h().formGroup,children:[(0,o.jsx)("label",{htmlFor:"appointmentDate",children:"Select Date"}),(0,o.jsx)("input",{type:"date",id:"appointmentDate",className:h().formInput,value:u,onChange:e=>f(e.target.value),min:(()=>{let e=new Date;return e.setDate(e.getDate()+1),e.toISOString().split("T")[0]})(),required:!0})]}),u&&r&&(0,o.jsxs)("div",{className:h().formGroup,children:[(0,o.jsx)("label",{children:"Select Time Slot"}),N?(0,o.jsx)("p",{children:"Loading available time slots..."}):0===g.length?(0,o.jsx)("p",{children:"No available time slots for this date. Please select another date."}):(0,o.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"10px"},children:g.map((e,t)=>(0,o.jsx)("button",{type:"button",onClick:()=>j(e.start),disabled:!e.available,style:{padding:"8px",border:b===e.start?"2px solid #3b82f6":"1px solid #d1d5db",borderRadius:"4px",backgroundColor:e.available?b===e.start?"rgba(59, 130, 246, 0.1)":"white":"#f3f4f6",cursor:e.available?"pointer":"not-allowed",opacity:e.available?1:.6},children:new Date("2000-01-01T".concat(e.start)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},t))})]}),(0,o.jsxs)("div",{className:h().formGroup,children:[(0,o.jsx)("label",{htmlFor:"reasonForVisit",children:"Reason for Visit"}),(0,o.jsx)("textarea",{id:"reasonForVisit",className:h().formInput,value:_,onChange:e=>y(e.target.value),rows:3,required:!0})]}),(0,o.jsxs)("div",{className:h().formGroup,children:[(0,o.jsx)("label",{htmlFor:"symptoms",children:"Symptoms (comma separated)"}),(0,o.jsx)("textarea",{id:"symptoms",className:h().formInput,value:v,onChange:e=>k(e.target.value),rows:2,placeholder:"e.g. headache, fever, cough"})]}),(0,o.jsxs)("div",{className:h().formGroup,style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,o.jsx)("input",{type:"checkbox",id:"isVirtual",checked:w,onChange:e=>S(e.target.checked)}),(0,o.jsx)("label",{htmlFor:"isVirtual",style:{margin:0},children:"Virtual Appointment (Telemedicine)"})]}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"20px"},children:[(0,o.jsx)(m(),{href:"/appointments",style:{padding:"10px 16px",border:"1px solid #d1d5db",borderRadius:"4px",textDecoration:"none",color:"#4b5563"},children:"Cancel"}),(0,o.jsx)("button",{type:"submit",className:h().button,disabled:T,style:{padding:"10px 20px"},children:T?"Booking...":"Book Appointment"})]})]})]})})]})}},7317:function(e){e.exports={container:"Dashboard_container__KcHrK",header:"Dashboard_header__N6bxR",logoutButton:"Dashboard_logoutButton__oi5JT",main:"Dashboard_main__w685B",grid:"Dashboard_grid__3NToH",card:"Dashboard_card__On9Pb",button:"Dashboard_button__idTka",appointmentsGrid:"Dashboard_appointmentsGrid__IPUk6",appointmentCard:"Dashboard_appointmentCard__uPiye",formContainer:"Dashboard_formContainer__E7yeN",formGroup:"Dashboard_formGroup__MUlGz",formInput:"Dashboard_formInput__teeW5",formSelect:"Dashboard_formSelect__SX1sM",formError:"Dashboard_formError__hDGfH"}}},function(e){e.O(0,[664,379,774,888,179],function(){return e(e.s=63)}),_N_E=e.O()}]);